solution <- rbind(c(0,0,1,0),c(0,0,1,1),c(0,0,1,1),c(1,0,1,1),c(2,0,1,1),c(2,1,1,1),c(2,2,1,1),c(2,2,2,1),c(2,2,2,2))
solution
colnames(solution) <- c("A","C","G","T")
solution
getTallyTableLine <- function(index,l.col,alphabet){
return(letterFrequency(l.col[seq_len(index)],alphabet))
}
getTallyTable <- function(l.col,rowwidth=1){
indexes <- as.matrix(seq(1,length(l.col),rowwidth))
alphabet <- names(which(alphabetFrequency(l.col,as.prob=FALSE,baseOnly=FALSE)!=0))
alphabet <- alphabet[alphabet!="."]
return(t(apply(indexes,1,getTallyTableLine,l.col=l.col,alphabet=alphabet)))
}
getTallyTable(Biostrings::DNAString("GT.AACCTG"))
library(Biostrings)
getTallyTable(Biostrings::DNAString("GT.AACCTG"))
getTallyTable(Biostings::DNAString("AGTTGACATTGTATATTGGCGAACCTACCATAG.ACCGCCATGCTATCGCAGTCGAATGATGTTGAGGTAGTAGTTCGACAACATCATTTCTTATTAAATTGGCGATTGGTCACCCGTTGACCAAATTTCTAAGGGTTATCATCAGTACAGATTCCTCTATGTCTCTGGGTCAGGTACTTCTGCTCGAAGGGCTTCGCAGTTAAATGGTCCCAAGCCTCGGCCGTACACTTTGCGGCCGGG"))
getTallyTable(Biostrings::DNAString("AGTTGACATTGTATATTGGCGAACCTACCATAG.ACCGCCATGCTATCGCAGTCGAATGATGTTGAGGTAGTAGTTCGACAACATCATTTCTTATTAAATTGGCGATTGGTCACCCGTTGACCAAATTTCTAAGGGTTATCATCAGTACAGATTCCTCTATGTCTCTGGGTCAGGTACTTCTGCTCGAAGGGCTTCGCAGTTAAATGGTCCCAAGCCTCGGCCGTACACTTTGCGGCCGGG"))
