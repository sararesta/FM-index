getSA <- function(sequence){
indexes <- as.matrix(seq(seq_len(nchar(sequence))))
suffixes <- apply(indexes,1,getSuffix,sequence=sequence)
names(suffixes) <- indexes
suffix.array <- as.integer(names(sort(suffixes)))
return(suffix.array)
}
getSA("hello")
getSuffix <- function(index,sequence){
substr(sequence,index,nchar(sequence))
}
getSA("hello")
getSA("abracadabra$")
getSA("banana")
getSA("banana$")
getSA("bananaban$")
getSA("bananaban.")
getBWTcharacter <- function(SA,sequence,suffixarray){
if(suffixarray[SA]>1){
return(substr(sequence,suffixarray[SA]-1,suffixarray[SA]-1))
}
else{
return(".")
}
}
getLcolumn <- function(sequence){
sequence <- paste(as.character(sequence),".",sep="")
indexes <- as.matrix(seq(seq_len(nchar(sequence))))
suffix.array <- getSA(sequence,indexes)
bwt <- apply(suffix.array,1,getBWTcharacter,
sequence=sequence,suffixarray=suffix.array)
return(DNAString(paste(bwt,collapse="")))
}
getBWTcharacter <- function(SA,sequence,suffixarray){
if(SA>1){
return(substr(sequence,SA-1,SA-1))
}
else{
return(".")
}
}
getLcolumn(Biostrings::DNAString("ACGT"))
getLcolumn <- function(sequence){
sequence <- paste(as.character(sequence),".",sep="")
indexes <- as.matrix(seq(seq_len(nchar(sequence))))
suffix.array <- getSA(sequence)
bwt <- apply(suffix.array,1,getBWTcharacter,
sequence=sequence,suffixarray=suffix.array)
return(DNAString(paste(bwt,collapse="")))
}
getLcolumn(Biostrings::DNAString("ACGT"))
getSA("banana")
dim(getSA("banana"))
length(getSA("banana"))
getSA("banana")[1]
getSA("banana")[2]
getLcolumn <- function(sequence){
seq_char <- paste(as.character(sequence),".",sep="")
indexes <- as.matrix(seq(seq_len(nchar(seq_char))))
suffix.array <- getSA(sequence)
bwt <- apply(indexes,1,getBWTcharacter,
sequence=seq_char,suffixarray=suffix.array)
}
getLcolumn <- function(sequence){
seq_char <- paste(as.character(sequence),".",sep="")
indexes <- as.matrix(seq(seq_len(nchar(seq_char))))
suffix.array <- getSA(sequence)
bwt <- apply(indexes,1,getBWTcharacter,
sequence=seq_char,suffixarray=suffix.array)
return(DNAString(paste(bwt,collapse="")))
}
getSA <- function(sequence){
seq_char <- paste(as.character(sequence),".",sep="")
indexes <- as.matrix(seq(seq_len(nchar(sequence))))
suffixes <- apply(indexes,1,getSuffix,sequence=sequence)
names(suffixes) <- indexes
suffix.array <- as.integer(names(sort(suffixes)))
return(suffix.array)
}
getSuffix <- function(index,sequence){
substr(sequence,index,nchar(sequence))
}
getBWTcharacter <- function(index,sequence,suffixarray){
if(suffixarray[index]>1){
return(substr(sequence,suffixarray[index]-1,suffixarray[index]-1))
}
else{
return(".")
}
}
getLcolumn(Biostrings::DNAString("ACGT"))
