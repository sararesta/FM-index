---
title: "FM Index of a DNA sequence contained in a FASTA file"
author: "Sara Resta"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
    %\VignetteIndexEntry{FM Index of a DNA sequence contained in a FASTA file}
    %\VignetteEngine{knitr::rmarkdown}
    %\VignetteEncoding{UTF-8}
---

```{r style, echo = FALSE, results = 'asis'}
library(BiocStyle)
```

```{r setup}
library(FMIndex)
```

```{r, echo = FALSE}
library(knitr)
```

# Introduction

FM index is a very important tool for compressing data

# FM index data structures

## F column

The F column is given as a integer, the names of the elements are the characters of the sequence.

```{r}
getFcolumn(Biostrings::DNAString("ACCT"))
```

## L column

The L column is the Burrows-Wheeler transformation of the give sequence. The function returns a DNAString.

```{r}
getLcolumn(Biostrings::DNAString("AACCGT"))
```

## Tally table

The Tally table contains

```{r}
getTallyTable(Biostrings::DNAString("T.AACCG"))
```

```{r}
getTallyTable(Biostrings::DNAString("T.AACCG"),2)
```

## Suffix Array

Sometimes the suffix array is included in the FM index to speed up the computation.

```{r}
getSA(Biostrings::DNAString("ACGTTC."))
```

# Computing the FM index

```{r}
FMindex(system.file("extdata/vignettes/seq5.fasta",package="FMIndex"),"")
```

```{r}
FMindex(system.file("extdata/vignettes/seq5.fasta",package="FMIndex"),"",includeSA=TRUE)
```
