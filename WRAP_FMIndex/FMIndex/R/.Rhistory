library(Biostrings)
#carica il file
fastafile <- "seq2.fasta"
seqset <- readDNAStringSet(fastafile,use.names=FALSE)
#first column
f.col <- oligonucleotideFrequency(seqset,1)
#extracting unique letters
nucleotides <- uniqueLetters(seqset)
nucleotides
#computing BWT
##variant 3
star.seq <- paste(as.character(seqset),".",sep="")
nchar(star.seq)
indexes <- as.matrix(seq(1:nchar(star.seq)))
indexes
getSuffix <- function(x,s){
substr(s,x,nchar(star.seq))
}
setwd("~/CORSI/SCIENTIFIC_PROGRAMMING/PROJECT/FM_INDEX")
suffixes <- apply(indexes,1,getSuffix,s=star.seq)
names(suffixes) <- indexes
library(Biostrings)
#carica il file
fastafile <- "seq2.fasta"
seqset <- readDNAStringSet(fastafile,use.names=FALSE)
seqset <- DNAString("AGCTTAACTGA")
#first column
f.col <- oligonucleotideFrequency(seqset,1)
#extracting unique letters
nucleotides <- uniqueLetters(seqset)
nucleotides
#computing BWT
##variant 3
star.seq <- paste(as.character(seqset),".",sep="")
nchar(star.seq)
indexes <- as.matrix(seq(1:nchar(star.seq)))
indexes
getSuffix <- function(x,s){
substr(s,x,nchar(star.seq))
}
suffixes <- apply(indexes,1,getSuffix,s=star.seq)
names(suffixes) <- indexes
suffixes[length(suffixes)]
suffix.array <- as.integer(names(sort(suffixes)))
getBWTcharacter <- function(x,s){
if(suffix.array[x]>1){
substr(s,suffix.array[x]-1,suffix.array[x]-1)
}
else{
"."
}
}
# my l column
bwt <- apply(indexes,1,getBWTcharacter,s=star.seq)
l.col <- DNAString(paste(bwt,collapse="")) #ottieni la bwt tutta attaccata
alphabet <- names(which(alphabetFrequency(l.col,as.prob=FALSE,baseOnly=FALSE)!=0))
tally <- matrix(nrow=nchar(l.col),ncol=length(alphabet))
create.tally <- function(x){
letterFrequency(l.col[1:x],alphabet)
}
tally.table <- t(apply(indexes,1,create.tally))
compressed.indexes <- as.matrix(seq(1,nchar(l.col),1000))
tally.table.compressed <- t(apply(compressed.indexes,1,create.tally))
write.table(tally.table, file = "prova.txt", sep = "\t", row.names = FALSE)
write(t(names(f.col)),file="prova2.txt",sep="\t")
write.table(t(as.matrix(f.col)), file = "prova2.txt", sep = "\t", row.names = FALSE)
write(f.col,file="prova2.txt",sep="\t",append=TRUE)
write(as.character(l.col),"prova3.txt")
setwd("~/CORSI/SCIENTIFIC_PROGRAMMING/PROJECT/WRAP_FMIndex/FMIndex/R")
DNAString("ACG")
seq_len("ACG")
seq_len(10)
a <- c(1,2,3,4,5,6,7,8,8,8,1)
a[seq_len(10)]
